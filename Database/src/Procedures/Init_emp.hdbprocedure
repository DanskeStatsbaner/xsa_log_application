PROCEDURE "DataWareHouse.Database.Procedures::Init_emp"(
IN
username NVARCHAR(500),
email_address NVARCHAR(500)
)
LANGUAGE SQLSCRIPT
SQL SECURITY INVOKER
AS
BEGIN SEQUENTIAL EXECUTION
emps = select USERNAME, EMAIL_ADDRESS from "DataWareHouse.Database.VirtualTables::init_emp" WHERE USERNAME NOT IN (SELECT DISTINCT USERNAME FROM "DataWareHouse.Database.Tables::log.mail_individual");

INSERT INTO "DataWareHouse.Database.Tables::log.mail_individual" SELECT * FROM :emps;

END
